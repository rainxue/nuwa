# 概览
BPM（Business Process Management）模块定义了业务流程管理相关的功能，包括流程定义、流程实例、任务等内容的管理。


# 主要功能
- 流程定义管理：支持创建、编辑、删除流程定义，定义流程的各个环节和节点。
- 流程实例管理：支持启动、暂停、终止流程实例，查看流程实例的状态和历史记录。
- 任务管理：支持任务的分配、处理、转交，查看任务的状态和历史记录。
- 流程监控：提供流程运行的监控和统计功能，帮助用户了解流程的执行情况和效率。
- 集成与扩展：支持与其他系统的集成，提供API接口，方便扩展和定制化开发。

# 需求分析
## 业务场景
业务场景1：
资源审核流程
- 资源创建者提交资源，触发审核流程。
- 审核人员审核资源，审核通过后资源发布，审核不通过则退回修改。
- 审核流程包括多个节点，如初审、复审等。


业务场景2：
门户用户反馈信息分配处理流程：
- 用户：用户在门户提交反馈信息，触发反馈处理流程。
- 系统：AI自动识别无效反馈内容，直接关闭处理，有效反馈内容转到人工处理节点。
- 运营：处理人批量拉取（认领）反馈信息，进行处理。
- 系统：处理完成后，反馈用户处理结果，关闭反馈单。
- 用户：查看反馈处理结果。
- 反馈处理流程包括多个节点，如自动识别、人工处理、结果反馈等


业务场景3：
学生请假流程：
- 学生/家长：学生或家长在门户提交请假申请，触发请假流程。
- 系统：AI自动识别请假类型，判断是否需要班主任审批，若不需要则直接归档。
- 班主任：若需要班主任审批，则班主任审核请假申请，审核通过则归档，审核不通过则退回修改。

业务场景3：
教师请假流程：
- 教师在门户提交请假申请，触发请假流程。
- 系统：AI自动识别请假类型，判断是否需要主管领导审批，若不需要则直接归档。
- 主管领导：若需要主管领导审批，则主管领导审核请假申请，审核通过则归档，审核不通过则退回修改。

## 需求分析
- 审批人支持指定个人（固定的资源审核人、学生选择班级的老师）、特定角色（学生所在班级的班主任、老师的直接上级、学校的人事主管）。
- 审核人支持指定角色（租户角色、指定群组及角色）
- 支持多级审核（初审、复审、终审等）
- 支持条件分支（如审核通过、审核不通过、请假天数<=3天等）

操作：
- 提交审核
- 任务认领
- 转交
- 审核通过
- 审核不通过
- 撤回
- 退回

数据获取模式：
- 系统自动分配到人员
- 系统自动分配到角色/群组，由角色/群组内人员认领
  - 推模式：拆解到人员待办任务列表，接收后取消其他人的任务。适合任务量较少，且一人多岗业务模式。
  - 拉模式：角色/群组内人员认领或拉取（批量认领）。适合任务池任务较多，且多人专岗业务模式。


# 初步设计
## 节点类型
- 开始节点（Start Event）：流程的起点，通常只有一个。
- 结束节点（End Event）：流程的终点，可以有多个。
- 任务节点（Task）：表示一个具体的工作任务，可以是用户任务或自动任务。
- 网关节点（Gateway）：用于控制流程的分支和合并，如并行网关、排他网关等。
- 子流程节点（Sub-Process）：表示一个嵌套的子流程，可以独立定义和管理。
- 事件节点（Event）：表示流程中的事件触发点，如定时事件、消息事件等。
- 连接线（Sequence Flow）：表示节点之间的流程走向，定义了流程的执行顺序。
- 边界事件（Boundary Event）：附加在任务节点上的事件，用于处理异常情况或中断任务。
- 事务节点（Transaction）：表示一个需要保证原子性的任务集合，通常用于复杂的业务操作。
- 轮询节点（Loop）：表示一个任务需要重复执行，直到满足某个条件。
- 多实例节点（Multi-Instance）：表示一个任务需要并行或串行地执行多次，通常用于批量处理。
- 事件子流程（Event Sub-Process）：表示一个独立的子流程，通常用于处理特定事件，如错误处理或补偿操作。
- 复合任务节点（Complex Task）：表示一个包含多个子任务的复杂任务，通常用于需要协调多个步骤的业务操作。
- 事务边界事件（Transaction Boundary Event）：附加在事务节点上的事件，用于处理事务的异常情况或中断事务。
- 信号事件（Signal Event）：用于在流程中广播或接收信号，实现跨流程的通信和协作。
- 消息事件（Message Event）：用于在流程中发送或接收消息，实现与外部系统的交互。
- 定时事件（Timer Event）：用于在流程中设置定时触发的事件，实现定时任务或延迟操作。
- 条件事件（Conditional Event）：用于在流程中根据特定条件触发的事件，实现动态流程控制。
- 取消事件（Cancel Event）：用于在流程中取消某个任务或子流程，实现流程的中断和回滚。
- 补偿事件（Compensation Event）：用于在流程中处理补偿操作，实现对已完成任务的撤销或修正。
- 错误事件（Error Event）：用于在流程中处理错误情况，实现异常处理和错误恢复。

